<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="http://edwardhotchkiss.github.com/short"

    >short (v2.6.0)</a>
</h1>
<h4>Node.js URL Shortener backed by Mongoose.js</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.short">module short</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.short.connect">
            function <span class="apidocSignatureSpan">short.</span>connect
            <span class="apidocSignatureSpan">(mongodb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.short.generate">
            function <span class="apidocSignatureSpan">short.</span>generate
            <span class="apidocSignatureSpan">(document)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.short.hits">
            function <span class="apidocSignatureSpan">short.</span>hits
            <span class="apidocSignatureSpan">(hash)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.short.list">
            function <span class="apidocSignatureSpan">short.</span>list
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.short.retrieve">
            function <span class="apidocSignatureSpan">short.</span>retrieve
            <span class="apidocSignatureSpan">(hash)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.short.update">
            function <span class="apidocSignatureSpan">short.</span>update
            <span class="apidocSignatureSpan">(hash, updates)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">short.</span>prototype</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.short.prototype">module short.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.short.prototype.Model">
            function <span class="apidocSignatureSpan">short.prototype.</span>Model
            <span class="apidocSignatureSpan">(mongooseModel)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.short" id="apidoc.module.short">module short</a></h1>


    <h2>
        <a href="#apidoc.element.short.connect" id="apidoc.element.short.connect">
        function <span class="apidocSignatureSpan">short.</span>connect
        <span class="apidocSignatureSpan">(mongodb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">connect = function (mongodb) {
  if (mongoose.connection.readyState === 0)
    mongoose.connect(mongodb);

  exports.connection = mongoose.connection;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
**Generates a Shortened URL Doc, then retrieves it for demo:**

```javascript
var shortURLPromise
  , short = require(&#x27;../lib/short&#x27;);

// connect to mongodb
short.<span class="apidocCodeKeywordSpan">connect</span>(&#x27;mongodb://localhost/short&#x27;);

short.connection.on(&#x27;error&#x27;, function(error) {
  throw new Error(error);
});

// promise to generate a shortened URL.
var shortURLPromise = short.generate({
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.short.generate" id="apidoc.element.short.generate">
        function <span class="apidocSignatureSpan">short.</span>generate
        <span class="apidocSignatureSpan">(document)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">generate = function (document) {
  var generatePromise
    , promise = new Promise();

  document[&#x27;data&#x27;] = document.data || null;

  // hash was specified, so we should always honor it
  if (document.hasOwnProperty(&#x27;hash&#x27;)) {
    generatePromise = ShortURL.create(document);
  } else {
    document[&#x27;hash&#x27;] = ID.store(document.URL);
    generatePromise = ShortURL.findOrCreate({URL : document.URL}, document, {});
  }

  generatePromise.then(function(ShortURLObject) {
    promise.resolve(ShortURLObject);
  }, function(error) {
    promise.reject(error, true);
  });

  return promise;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
short.connect(&#x27;mongodb://localhost/short&#x27;);

short.connection.on(&#x27;error&#x27;, function(error) {
throw new Error(error);
});

// promise to generate a shortened URL.
var shortURLPromise = short.<span class="apidocCodeKeywordSpan">generate</span>({
URL : &#x27;http://nodejs.org/&#x27;
});

// gets back the short url document, and then retrieves it
shortURLPromise.then(function(mongodbDoc) {
console.log(&#x27;&#x3e;&#x3e; created short URL:&#x27;);
console.log(mongodbDoc);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.short.hits" id="apidoc.element.short.hits">
        function <span class="apidocSignatureSpan">short.</span>hits
        <span class="apidocSignatureSpan">(hash)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hits = function (hash) {
  var promise = new Promise();
  var query = { hash : hash }
    , options = { multi: true };
  var retrievePromise = ShortURL.findOne(query);
  retrievePromise.then(function(ShortURLObject) {
    if (ShortURLObject &#x26;&#x26; ShortURLObject !== null) {
      promise.resolve(ShortURLObject.hits);
    } else {
      promise.reject(new Error(&#x27;MongoDB - Cannot find Document&#x27;), true);
    };
  }, function(error) {
    promise.reject(error, true);
  });
  return promise;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.short.list" id="apidoc.element.short.list">
        function <span class="apidocSignatureSpan">short.</span>list
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">list = function () {
  return ShortURL.find({});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
short.connect(&#x27;mongodb://localhost/short&#x27;);

short.connection.on(&#x27;error&#x27;, function(error) {
  throw new Error(error);
});

// promise to retrieve all shortened URLs
listURLsPromise = short.<span class="apidocCodeKeywordSpan">list</span>();

// output all resulting shortened url db docs
listURLsPromise.then(function(URLsDocument) {
  console.log(&#x27;&#x3e;&#x3e; listing (%d) Shortened URLS:&#x27;, URLsDocument.length);
  console.log(URLsDocument);
  process.exit(0);
}, function(error) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.short.retrieve" id="apidoc.element.short.retrieve">
        function <span class="apidocSignatureSpan">short.</span>retrieve
        <span class="apidocSignatureSpan">(hash)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">retrieve = function (hash) {
  var promise = new Promise();
  var query = { hash : hash }
    , update = { $inc: { hits: 1 } }
    , options = { multi: true };
  var retrievePromise = ShortURL.findOne(query);
  ShortURL.update( query, update , options , function (){ } );
  retrievePromise.then(function(ShortURLObject) {
    if (ShortURLObject &#x26;&#x26; ShortURLObject !== null) {
      promise.resolve(ShortURLObject);
    } else {
      promise.reject(new Error(&#x27;MongoDB - Cannot find Document&#x27;), true);
    };
  }, function(error) {
    promise.reject(error, true);
  });
  return promise;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
});

// gets back the short url document, and then retrieves it
shortURLPromise.then(function(mongodbDoc) {
console.log(&#x27;&#x3e;&#x3e; created short URL:&#x27;);
console.log(mongodbDoc);
console.log(&#x27;&#x3e;&#x3e; retrieving short URL: %s&#x27;, mongodbDoc.hash);
short.<span class="apidocCodeKeywordSpan">retrieve</span>(mongodbDoc.hash).then(function(result) {
  console.log(&#x27;&#x3e;&#x3e; retrieve result:&#x27;);
  console.log(result);
  process.exit(0);
}, function(error) {
  if (error) {
    throw new Error(error);
  }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.short.update" id="apidoc.element.short.update">
        function <span class="apidocSignatureSpan">short.</span>update
        <span class="apidocSignatureSpan">(hash, updates)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">update = function (hash, updates) {
  var promise = new Promise();
  ShortURL.findOne({hash: hash}, function(err, doc) {
    if (updates.URL) {
      doc.URL = updates.URL;
    }
    if (updates.data) {
      doc.data = extend(doc.data, updates.data);
      doc.markModified(&#x27;data&#x27;); //Required by mongoose, as data is of Mixed type
    }
    doc.save(function(err, updatedObj, numAffected) {
      if (err) {
        promise.reject(new Error(&#x27;MongoDB - Cannot save updates&#x27;), true);
      } else {
        promise.resolve(updatedObj);
      }
    });
  });
  return promise;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
});
```

**Updating the URL or the data fields of an existing Short URL hash**

```javascript
// Basically, update works like this
var updatePromise = short.<span class="apidocCodeKeywordSpan">update</span>(hash, updateData);
// hash =&#x3e; Short url hashcode generated using short.generate()
// updateData =&#x3e; An object consisting of the new URL and/or the new data object.
//               If a key already exists in the current data object, it&#x27;s value is updated,
//               otherwise, it is added and saved to the data object

//This function returns a promise which on resolution returns the new updated object as an argument.
```
...</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.short.prototype" id="apidoc.module.short.prototype">module short.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.short.prototype.Model" id="apidoc.element.short.prototype.Model">
        function <span class="apidocSignatureSpan">short.prototype.</span>Model
        <span class="apidocSignatureSpan">(mongooseModel)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">Model = function (mongooseModel) {
  this.baseModel = mongooseModel;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  URL        : { type : String, unique: false },
  hash       : { type : String, unique: true },
  hits       : { type : Number, default: 0 },
  data       : { type : Schema.Types.Mixed },
  created_at : { type : Date, default: Date.now },
}, options);

exports.ShortURL = new wrapper.<span class="apidocCodeKeywordSpan">Model</span>(mongoose.model(&#x27;ShortURL&#x27;, ShortURLSchema
));
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
